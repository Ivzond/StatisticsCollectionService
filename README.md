# Statistics Collection Service

## Описание

Statistics Collection Service представляет собой микросервис на языке Go для сбора и хранения статистических данных.

## Использование

### Установка и настройка

1. Установите Go версии 1.12 или выше.

2. Склонируйте данный репозиторий

3. Установите зависимости проекта

```
go mod download
```
4. Настройте подключение к базе данных PostgreSQL в файле `internal/db/db.go`

### Сборка и запуск
Используйте утилиту make для управления процессом сборки и запуска:
```
make build  # Сборка проекта
make run    # Запуск сервиса
```
Сервис будет доступен по адресу http://localhost:8080.

Для очистки временных файлов и бинарного файла выполните:
```
make clean
```

## API Endpoints
* GET `/orderbook/get`
    
    Получить информацию о книге заявок для заданной биржи и валютной пары.

* POST `/orderbook/save`

    Сохранить информацию о книге заявок для заданной биржи и валютной пары.

* GET `/orderhistory/get`

    Получить историю заказов для указанного клиента.

* POST `/order/save`

    Сохранить информацию о заказе для указанного клиента.

## Тестирование
Для запуска unit-тестов выполните:
```
make test
```

## Нагрузочное тестирование
Нагрузочное тестирование проводилось с помощью Apache JMeter. Во время тестирования сервис показал следующие результаты:
* **Производительность**: Время отклика не более 200 мс
* **RPS(запись)**: До 200 запросов в секунду
* **RPS(чтение)**: До 100 запросов в секунду

### Параметры тестирования
* Тестирование проводилось с использование 100 пользователей(Threads) на чтение и 200 на запись с *ramp-up period* в 10 секунд
* Запросы на чтение (GetOrderBook и GetOrderHistory) показали максимальное время отклика в 28 мс и выполнялись в среднем с 99.5 RPS
* Запросы на запись (SaveOrderBook и SaveOrder) показали максимальное время отклика в 22 мс и выполнялись в среднем с 200.8 RPS

### Для запуска нагрузочного тестирования с помощью Apache JMeter выполните следующие шаги:
1. Откройте JMeter и загрузите файл тест-плана `loadTesting/StatService.jmx`
2. Настройте параметры тестирования по необходимости
3. Запустите тест и анализируйте результаты